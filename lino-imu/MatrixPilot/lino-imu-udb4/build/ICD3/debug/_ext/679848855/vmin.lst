MPLAB ASM30 Listing:  ../../libVectorMatrix/vmin.s 			page 1


   1              	;*********************************************************************
   2              	;                                                                    *
   3              	;                       Software License Agreement                   *
   4              	;                                                                    *
   5              	;   The software supplied herewith by Microchip Technology           *
   6              	;   Incorporated (the "Company") for its dsPIC controller            *
   7              	;   is intended and supplied to you, the Company's customer,         *
   8              	;   for use solely and exclusively on Microchip dsPIC                *
   9              	;   products. The software is owned by the Company and/or its        *
  10              	;   supplier, and is protected under applicable copyright laws. All  *
  11              	;   rights are reserved. Any use in violation of the foregoing       *
  12              	;   restrictions may subject the user to criminal sanctions under    *
  13              	;   applicable laws, as well as to civil liability for the breach of *
  14              	;   the terms and conditions of this license.                        *
  15              	;                                                                    *
  16              	;   THIS SOFTWARE IS PROVIDED IN AN "AS IS" CONDITION.  NO           *
  17              	;   WARRANTIES, WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING,    *
  18              	;   BUT NOT LIMITED TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND    *
  19              	;   FITNESS FOR A PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE     *
  20              	;   COMPANY SHALL NOT, IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL,  *
  21              	;   INCIDENTAL OR CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.  *
  22              	;                                                                    *
  23              	;   (c) Copyright 2003 Microchip Technology, All rights reserved.    *
  24              	;*********************************************************************
  25              	
  26              		; Local inclusions.
  28              		.list
  29              	
  30              	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  31              	
  32              		.section .libdsp, code
  33              	
  34              	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  35              	;
  36              	; _VectorMin: Vector Minimum Value (and last index with minimum value).
  37              	;
  38              	; Operation:
  39              	;	minVal = min {srcV[n], n in {0, 1,...numElems-1} }
  40              	;   residually,
  41              	;	if srcV[i] = srcV[j] = minVal, and i < j, then *(minIndex) = j
  42              	;
  43              	; Input:
  44              	;	w0 = number elements in vector(s) (numElems)
  45              	;	w1 = ptr to source vector (srcV)
  46              	;	w2 = ptr to index of minimum value (&minIndex)
  47              	; Return:
  48              	;	w0 = minimum value (minVal)
  49              	;
  50              	; System resources usage:
  51              	;	{w0..w5}	used, not restored
  52              	;
  53              	; DO and REPEAT instruction usage.
  54              	;	no DO intructions
  55              	;	no REPEAT intructions
  56              	;
  57              	; Program words (24-bit instructions):
  58              	;	13
MPLAB ASM30 Listing:  ../../libVectorMatrix/vmin.s 			page 2


  59              	;
  60              	; Cycles (including C-function call and return overheads):
  61              	;	14			(if numElems == 1)
  62              	;	20 + 8*(numElems-2)	(if srcV[n] >= srcV[n+1], 0 <= n < numElems-1)
  63              	;	19 + 7*(numElems-2)	(if srcV[n] <  srcV[n+1], 0 <= n < numElems-1)
  64              	;............................................................................
  65              	
  66              		.global	_VectorMin	; export
  67              	_VectorMin:
  68              	
  69              	;............................................................................
  70              	
  71 000000  B1 02 78 		mov	[w1++],w5			; w5 = srcV[0] (current minVal)
  72 000002  00 09 EB 		clr	[w2]				; *w2 = current min value index
  73 000004  00 02 E9 		dec	w0,w4				; w4 = numElems-1
  74 000006  00 00 34 		bra	le,_endMin			; no more elements...
  75              	_compare:
  76 000008  B1 01 78 		mov	[w1++],w3			; w3 = srcV[n+1]
  77 00000a  03 28 E1 		cp	w5,w3				; srcV[n] < srcV[n+1] ?
  78 00000c  00 00 35 		bra	lt,_noUpdate			; yes => no update
  79              	_doUpdate:					; no  => do update
  80 00000e  83 02 78 		mov	w3,w5				; w5 = (current minVal)
  81 000010  04 09 50 		sub	w0,w4,[w2]			; *w2 = current min value index
  82              	_noUpdate:
  83 000012  04 02 E9 		dec	w4,w4				; w4 = numElems-n
  84 000014  00 00 3C 		bra	gt,_compare			; no more elements...
  85              	_endMin:
  86 000016  05 00 78 		mov	w5,w0				; restore return value
  87              	
  88              	;............................................................................
  89              	
  90 000018  00 00 06 		return	
  91              	
  92              	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
  93              	
  94              		.end
MPLAB ASM30 Listing:  ../../libVectorMatrix/vmin.s 			page 3


DEFINED SYMBOLS
                            *ABS*:00000000 fake
                            *ABS*:00000001 PSV_ERRATA
                            *ABS*:00000001 __MPLAB_DEBUGGER_ICD3
                            *ABS*:00000001 __DEBUG
                            *ABS*:00000001 __MPLAB_DEBUG
                            *ABS*:00000001 __ICD2RAM
                            *ABS*:00000001 __MPLAB_BUILD
                            *ABS*:00000001 __33FJ256GP710A
                            *ABS*:00000001 __dsPIC33F
                            *ABS*:00000001 __HAS_DSP
                            *ABS*:00000001 __HAS_DMA
                            *ABS*:00000001 __HAS_CODEGUARD
                            *ABS*:00000001 __C30COFF
../../libVectorMatrix/vmin.s:67     .libdsp:00000000 _VectorMin
../../libVectorMatrix/vmin.s:85     .libdsp:00000016 _endMin
../../libVectorMatrix/vmin.s:75     .libdsp:00000008 _compare
../../libVectorMatrix/vmin.s:82     .libdsp:00000012 _noUpdate
../../libVectorMatrix/vmin.s:79     .libdsp:0000000e _doUpdate

NO UNDEFINED SYMBOLS

EQUATE SYMBOLS
                      PSV_ERRATA = 0x1
           __MPLAB_DEBUGGER_ICD3 = 0x1
                         __DEBUG = 0x1
                   __MPLAB_DEBUG = 0x1
                       __ICD2RAM = 0x1
                   __MPLAB_BUILD = 0x1
                 __33FJ256GP710A = 0x1
                      __dsPIC33F = 0x1
                       __HAS_DSP = 0x1
                       __HAS_DMA = 0x1
                 __HAS_CODEGUARD = 0x1
                       __C30COFF = 0x1
